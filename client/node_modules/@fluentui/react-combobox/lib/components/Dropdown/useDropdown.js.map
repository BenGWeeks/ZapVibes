{"version":3,"sources":["useDropdown.tsx"],"sourcesContent":["import * as React from 'react';\nimport { useFieldControlProps_unstable } from '@fluentui/react-field';\nimport { ChevronDownRegular as ChevronDownIcon } from '@fluentui/react-icons';\nimport { getPartitionedNativeProps, useMergedRefs, slot } from '@fluentui/react-utilities';\nimport { useComboboxBaseState } from '../../utils/useComboboxBaseState';\nimport { useComboboxPositioning } from '../../utils/useComboboxPositioning';\nimport { Listbox } from '../Listbox/Listbox';\nimport type { DropdownProps, DropdownState } from './Dropdown.types';\nimport { useListboxSlot } from '../../utils/useListboxSlot';\nimport { useButtonTriggerSlot } from './useButtonTriggerSlot';\n\n/**\n * Create the state required to render Dropdown.\n *\n * The returned state can be modified with hooks such as useDropdownStyles_unstable,\n * before being passed to renderDropdown_unstable.\n *\n * @param props - props from this instance of Dropdown\n * @param ref - reference to root HTMLElement of Dropdown\n */\nexport const useDropdown_unstable = (props: DropdownProps, ref: React.Ref<HTMLButtonElement>): DropdownState => {\n  // Merge props from surrounding <Field>, if any\n  props = useFieldControlProps_unstable(props, { supportsLabelFor: true, supportsSize: true });\n\n  const baseState = useComboboxBaseState(props);\n  const { open } = baseState;\n\n  const { primary: triggerNativeProps, root: rootNativeProps } = getPartitionedNativeProps({\n    props,\n    primarySlotTagName: 'button',\n    excludedPropNames: ['children'],\n  });\n\n  const [comboboxPopupRef, comboboxTargetRef] = useComboboxPositioning(props);\n\n  const triggerRef = React.useRef<HTMLButtonElement>(null);\n  const listbox = useListboxSlot(props.listbox, comboboxPopupRef, {\n    state: baseState,\n    triggerRef,\n    defaultProps: {\n      children: props.children,\n    },\n  });\n\n  const trigger = useButtonTriggerSlot(props.button ?? {}, useMergedRefs(triggerRef, ref), {\n    state: baseState,\n    defaultProps: {\n      type: 'button',\n      tabIndex: 0,\n      children: baseState.value || props.placeholder,\n      ...triggerNativeProps,\n    },\n  });\n\n  const rootSlot = slot.always(props.root, {\n    defaultProps: {\n      'aria-owns': !props.inlinePopup && open ? listbox?.id : undefined,\n      children: props.children,\n      ...rootNativeProps,\n    },\n    elementType: 'div',\n  });\n  rootSlot.ref = useMergedRefs(rootSlot.ref, comboboxTargetRef);\n\n  const state: DropdownState = {\n    components: { root: 'div', button: 'button', expandIcon: 'span', listbox: Listbox },\n    root: rootSlot,\n    button: trigger,\n    listbox: open ? listbox : undefined,\n    expandIcon: slot.optional(props.expandIcon, {\n      renderByDefault: true,\n      defaultProps: {\n        children: <ChevronDownIcon />,\n      },\n      elementType: 'span',\n    }),\n    placeholderVisible: !baseState.value && !!props.placeholder,\n    ...baseState,\n  };\n\n  return state;\n};\n"],"names":["React","useFieldControlProps_unstable","ChevronDownRegular","ChevronDownIcon","getPartitionedNativeProps","useMergedRefs","slot","useComboboxBaseState","useComboboxPositioning","Listbox","useListboxSlot","useButtonTriggerSlot","useDropdown_unstable","props","ref","supportsLabelFor","supportsSize","baseState","open","primary","triggerNativeProps","root","rootNativeProps","primarySlotTagName","excludedPropNames","comboboxPopupRef","comboboxTargetRef","triggerRef","useRef","listbox","state","defaultProps","children","trigger","button","type","tabIndex","value","placeholder","rootSlot","always","inlinePopup","id","undefined","elementType","components","expandIcon","optional","renderByDefault","placeholderVisible"],"mappings":"AAAA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,6BAA6B,QAAQ,wBAAwB;AACtE,SAASC,sBAAsBC,eAAe,QAAQ,wBAAwB;AAC9E,SAASC,yBAAyB,EAAEC,aAAa,EAAEC,IAAI,QAAQ,4BAA4B;AAC3F,SAASC,oBAAoB,QAAQ,mCAAmC;AACxE,SAASC,sBAAsB,QAAQ,qCAAqC;AAC5E,SAASC,OAAO,QAAQ,qBAAqB;AAE7C,SAASC,cAAc,QAAQ,6BAA6B;AAC5D,SAASC,oBAAoB,QAAQ,yBAAyB;AAE9D;;;;;;;;CAQC,GACD,OAAO,MAAMC,uBAAuB,CAACC,OAAsBC;IACzD,+CAA+C;IAC/CD,QAAQZ,8BAA8BY,OAAO;QAAEE,kBAAkB;QAAMC,cAAc;IAAK;IAE1F,MAAMC,YAAYV,qBAAqBM;IACvC,MAAM,EAAEK,IAAI,EAAE,GAAGD;IAEjB,MAAM,EAAEE,SAASC,kBAAkB,EAAEC,MAAMC,eAAe,EAAE,GAAGlB,0BAA0B;QACvFS;QACAU,oBAAoB;QACpBC,mBAAmB;YAAC;SAAW;IACjC;IAEA,MAAM,CAACC,kBAAkBC,kBAAkB,GAAGlB,uBAAuBK;IAErE,MAAMc,aAAa3B,MAAM4B,MAAM,CAAoB;IACnD,MAAMC,UAAUnB,eAAeG,MAAMgB,OAAO,EAAEJ,kBAAkB;QAC9DK,OAAOb;QACPU;QACAI,cAAc;YACZC,UAAUnB,MAAMmB,QAAQ;QAC1B;IACF;QAEqCnB;IAArC,MAAMoB,UAAUtB,qBAAqBE,CAAAA,gBAAAA,MAAMqB,MAAM,cAAZrB,2BAAAA,gBAAgB,CAAC,GAAGR,cAAcsB,YAAYb,MAAM;QACvFgB,OAAOb;QACPc,cAAc;YACZI,MAAM;YACNC,UAAU;YACVJ,UAAUf,UAAUoB,KAAK,IAAIxB,MAAMyB,WAAW;YAC9C,GAAGlB,kBAAkB;QACvB;IACF;IAEA,MAAMmB,WAAWjC,KAAKkC,MAAM,CAAC3B,MAAMQ,IAAI,EAAE;QACvCU,cAAc;YACZ,aAAa,CAAClB,MAAM4B,WAAW,IAAIvB,OAAOW,oBAAAA,8BAAAA,QAASa,EAAE,GAAGC;YACxDX,UAAUnB,MAAMmB,QAAQ;YACxB,GAAGV,eAAe;QACpB;QACAsB,aAAa;IACf;IACAL,SAASzB,GAAG,GAAGT,cAAckC,SAASzB,GAAG,EAAEY;IAE3C,MAAMI,QAAuB;QAC3Be,YAAY;YAAExB,MAAM;YAAOa,QAAQ;YAAUY,YAAY;YAAQjB,SAASpB;QAAQ;QAClFY,MAAMkB;QACNL,QAAQD;QACRJ,SAASX,OAAOW,UAAUc;QAC1BG,YAAYxC,KAAKyC,QAAQ,CAAClC,MAAMiC,UAAU,EAAE;YAC1CE,iBAAiB;YACjBjB,cAAc;gBACZC,wBAAU,oBAAC7B;YACb;YACAyC,aAAa;QACf;QACAK,oBAAoB,CAAChC,UAAUoB,KAAK,IAAI,CAAC,CAACxB,MAAMyB,WAAW;QAC3D,GAAGrB,SAAS;IACd;IAEA,OAAOa;AACT,EAAE"}